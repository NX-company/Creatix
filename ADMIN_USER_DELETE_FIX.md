# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∞–¥–º–∏–Ω–∫–µ

**–î–∞—Ç–∞:** 16 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**

–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∞–¥–º–∏–Ω–∫–∏ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
DELETE http://localhost:3000/api/admin/users 
405 (Method Not Allowed)
```

**–ü—Ä–∏—á–∏–Ω–∞:** –í API endpoint `/api/admin/users` –Ω–µ –±—ã–ª —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `DELETE`.

---

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ:**

–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `DELETE` –≤ `app/api/admin/users/route.ts`:

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤:**
   - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ `verifyAdmin(request)`
   - –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è `userId` –≤ –∑–∞–ø—Ä–æ—Å–µ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - **–ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–æ–≤** (–Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ä–æ–ª—å—é `ADMIN`)

3. **–£–¥–∞–ª–µ–Ω–∏–µ:**
   - –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–±–ª–∞–≥–æ–¥–∞—Ä—è `onDelete: Cascade` –≤ —Å—Ö–µ–º–µ Prisma)
   - –£–¥–∞–ª—è—é—Ç—Å—è: –ø—Ä–æ–µ–∫—Ç—ã, —Ñ–∞–π–ª—ã, —Å–µ—Å—Å–∏–∏, API usage, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```
   ‚úÖ User deleted by admin: user@example.com
   ```

---

## üîê **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ä–æ–ª—å—é `ADMIN`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —É–¥–∞–ª–µ–Ω–∏—è

---

## üìã **–ö–æ–¥:**

```typescript
export async function DELETE(request: NextRequest) {
  try {
    const admin = await verifyAdmin(request)

    if (!admin) {
      return NextResponse.json(
        { error: 'Unauthorized' },
        { status: 401 }
      )
    }

    const { userId } = await request.json()

    if (!userId) {
      return NextResponse.json(
        { error: 'User ID is required' },
        { status: 400 }
      )
    }

    const user = await prisma.user.findUnique({
      where: { id: userId },
      select: { email: true, role: true }
    })

    if (!user) {
      return NextResponse.json(
        { error: 'User not found' },
        { status: 404 }
      )
    }

    // –ó–∞—â–∏—Ç–∞ –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–æ–≤
    if (user.role === 'ADMIN') {
      return NextResponse.json(
        { error: 'Cannot delete admin users' },
        { status: 403 }
      )
    }

    await prisma.user.delete({
      where: { id: userId }
    })

    console.log(`‚úÖ User deleted by admin: ${user.email}`)

    return NextResponse.json({
      success: true,
      message: 'User deleted successfully'
    })
  } catch (error) {
    console.error('User delete error:', error)
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    )
  }
}
```

---

## üß™ **–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**

1. **–í–æ–π–¥–∏—Ç–µ –≤ –∞–¥–º–∏–Ω–∫—É:**
   ```
   http://localhost:3000/admin
   ```

2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"**

3. **–ù–∞–∂–º–∏—Ç–µ –∏–∫–æ–Ω–∫—É –∫–æ—Ä–∑–∏–Ω—ã** —É –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫—Ä–æ–º–µ –∞–¥–º–∏–Ω–∞)

4. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ** –≤ –¥–∏–∞–ª–æ–≥–æ–≤–æ–º –æ–∫–Ω–µ

5. **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω
   - –°–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω
   - –í –∫–æ–Ω—Å–æ–ª–∏: `‚úÖ User deleted by admin: user@example.com`

---

## ‚ö†Ô∏è **–í–∞–∂–Ω–æ:**

- **–ê–¥–º–∏–Ω–æ–≤ —É–¥–∞–ª–∏—Ç—å –Ω–µ–ª—å–∑—è** (–∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è)
- **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:** —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø—Ä–æ–µ–∫—Ç—ã, —Ñ–∞–π–ª—ã, —Å–µ—Å—Å–∏–∏ –∏ —Ç.–¥.)
- **–û–ø–µ—Ä–∞—Ü–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞!** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ

---

## üìä **–ß—Ç–æ —É–¥–∞–ª—è–µ—Ç—Å—è:**

–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞—Å–∫–∞–¥–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è:
- ‚úÖ –í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã (`Project`)
- ‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤ (`ProjectMessage`)
- ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–æ–≤ (`ProjectFile`)
- ‚úÖ Planning –¥–∞–Ω–Ω—ã–µ (`ProjectPlanningData`)
- ‚úÖ –°–µ—Å—Å–∏–∏ (`Session`)
- ‚úÖ API usage –ª–æ–≥–∏ (`ApiUsage`)
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (`Transaction`)
- ‚úÖ Accounts (Google OAuth —Å–≤—è–∑–∏)

---

## üéâ **–ò—Ç–æ–≥:**

‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –∞–¥–º–∏–Ω–∫–∏ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `app/api/admin/users/route.ts` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ DELETE

