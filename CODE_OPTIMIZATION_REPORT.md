# ๐ ะะขะงะะข ะะ ะะะขะะะะะะฆะะ ะ ะงะะกะขะะ ะะะะ

**ะะฐัะฐ**: 26.10.2025
**ะะตััะธั**: 2.1 (ะะพัะปะต ะบะพะผะฟะปะตะบัะฝะพะน ะพะฟัะธะผะธะทะฐัะธะธ)

---

## โ ะะซะะะะะะะะซะ ะะะะะงะ

### 1. โ ะฃะดะฐะปะตะฝ ะฝะตะธัะฟะพะปัะทัะตะผัะน ะบะพะด PRO ัะตะถะธะผะฐ

**ะคะฐะนะป**: `lib/agents/orchestrator.ts`

**ะฃะดะฐะปะตะฝะพ**: ~100 ัััะพะบ ะบะพะดะฐ (ัััะพะบะธ 213-312)

**ะงัะพ ะฑัะปะพ ัะดะฐะปะตะฝะพ**:
- ะะปะพะบ `else if (mode === 'pro')` - ะฒะตัั ะบะพะด PRO ัะตะถะธะผะฐ
- ะะตะฝะตัะฐัะธั ะธะทะพะฑัะฐะถะตะฝะธะน ะดะปั PRO
- HTML ะบะพะผะฟะพะทะธัะธั ะดะปั PRO
- ะะพะณะธะบะฐ ะพะฑัะฐะฑะพัะบะธ ะทะฐะณััะถะตะฝะฝัั ะธะทะพะฑัะฐะถะตะฝะธะน ะดะปั PRO

**ะัะธัะธะฝะฐ**: PRO ัะตะถะธะผ ะฑัะป ะฟะตัะตะธะผะตะฝะพะฒะฐะฝ ะฒ ADVANCED. ะกัะฐััะน ะบะพะด ะฑะพะปััะต ะฝะต ะธัะฟะพะปัะทัะตััั ะธ ัะพะปัะบะพ ัะพะทะดะฐะฒะฐะป ะฟััะฐะฝะธัั.

**ะะตะทัะปััะฐั**:
- ะะพะด ััะฐะป ัะธัะต ะธ ะฟะพะฝััะฝะตะต
- ะฃะผะตะฝััะตะฝ ัะฐะทะผะตั ัะฐะนะปะฐ ะฝะฐ ~25%
- ะกะฝะธะถะตะฝะฐ ัะปะพะถะฝะพััั ะฟะพะดะดะตัะถะบะธ

---

### 2. ๐ง ะัะฟัะฐะฒะปะตะฝั deprecated ััะฝะบัะธะธ

**ะัะพะฑะปะตะผะฐ**: ะคัะฝะบัะธั `getNextResetDate()` ะฟะพะผะตัะตะฝะฐ ะบะฐะบ deprecated, ะฝะพ ะธัะฟะพะปัะทะพะฒะฐะปะฐัั ะฒ 3 ัะฐะนะปะฐั.

**ะะทะผะตะฝะตะฝั ัะฐะนะปั**:
1. `components/GenerationLimitModal.tsx` (ัััะพะบะฐ 6, 41)
2. `app/api/user/generations/route.ts` (ัััะพะบะฐ 5, 54)
3. `lib/generationLimits.ts` (ัััะพะบะฐ 162-165)

**ะงัะพ ัะดะตะปะฐะฝะพ**:
- ะะฐะผะตะฝะตะฝั ะฒัะต ะธะผะฟะพััั ั `getNextResetDate` ะฝะฐ `getNextFreeResetDate`
- ะะฐะผะตะฝะตะฝั ะฒัะต ะฒัะทะพะฒั ััะฝะบัะธะธ
- ะฃะดะฐะปะตะฝะฐ deprecated ััะฝะบัะธั ะธะท `generationLimits.ts`

**ะะตะทัะปััะฐั**:
- โ ะฃะฑัะฐะฝั warning ะฒ ะบะพะฝัะพะปะธ ะฑัะฐัะทะตัะฐ
- โ ะะพะด ะธัะฟะพะปัะทัะตั ะฐะบััะฐะปัะฝัะต API
- โ ะฃะปัััะตะฝะฐ ัะธัะฐะตะผะพััั ะบะพะดะฐ

---

### 3. ๐ ะะพะฑะฐะฒะปะตะฝะฐ ะบะพะผะฟะปะตะบัะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั

**ะคะฐะนะป**: `lib/agents/orchestrator.ts`

**ะะพะฑะฐะฒะปะตะฝะพ**:
- 32 ัััะพะบะธ ะดะพะบัะผะตะฝัะฐัะธะธ ะฒ ะฝะฐัะฐะปะต ัะฐะนะปะฐ
- ะะฟะธัะฐะฝะธะต ัะตะถะธะผะพะฒ ัะฐะฑะพัั (ADVANCED, FREE)
- ะกัะตะผะฐ ัะฐะฑะพัั ะณะตะฝะตัะฐัะธะธ ะดะพะบัะผะตะฝัะพะฒ
- ะะพะผะผะตะฝัะฐัะธะธ ะบ ะบะปััะตะฒัะผ ัะตะบัะธัะผ ะบะพะดะฐ

**ะคะฐะนะป**: `lib/generationLimits.ts`

**ะะพะฑะฐะฒะปะตะฝะพ**:
- 31 ัััะพะบะฐ ะดะพะบัะผะตะฝัะฐัะธะธ ะฒ ะฝะฐัะฐะปะต ัะฐะนะปะฐ
- ะะพะดัะพะฑะฝะพะต ะพะฟะธัะฐะฝะธะต ะฒัะตั ัะฐัะธัะฝัั ะฟะปะฐะฝะพะฒ
- ะฅะฐัะฐะบัะตัะธััะธะบะธ ะบะฐะถะดะพะณะพ ัะตะถะธะผะฐ
- ะะฝัะพัะผะฐัะธั ะพ ะปะธะผะธัะฐั ะธ ะฒะพะทะผะพะถะฝะพัััั

**ะะตะทัะปััะฐั**:
- โ ะะพะด ัะฐะผะพะดะพะบัะผะตะฝัะธััะตะผัะน
- โ ะะตะณะบะพ ะฟะพะฝััั ะบะฐะบ ัะฐะฑะพัะฐะตั ัะธััะตะผะฐ
- โ ะะพะฒัะต ัะฐะทัะฐะฑะพััะธะบะธ ะฑััััะตะต ัะฐะทะฑะตััััั

---

### 4. ๐ฏ ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฐ ะปะพะณะธะบะฐ ะณะตะฝะตัะฐัะธะธ ะธะทะพะฑัะฐะถะตะฝะธะน

**ะคะฐะนะป**: `lib/agents/orchestrator.ts`

**ะงัะพ ัะดะตะปะฐะฝะพ**:
- ะะพะฑะฐะฒะปะตะฝั ัะตัะบะธะต ะทะฐะณะพะปะพะฒะบะธ ัะตะบัะธะน
- ะฃะปัััะตะฝั ะบะพะผะผะตะฝัะฐัะธะธ ะบ ADVANCED ะธ FREE ัะตะถะธะผะฐะผ
- ะะฐะทะณัะฐะฝะธัะตะฝะฐ ะปะพะณะธะบะฐ ะณะตะฝะตัะฐัะธะธ ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ ะธ ะฑะตะท

**ะะพ**:
```typescript
if (mode === 'advanced') {
  // ะะตะฝะตัะฐัะธั ะธะทะพะฑัะฐะถะตะฝะธะน...
}
```

**ะะพัะปะต**:
```typescript
// ============================================
// ADVANCED ะะะะะ: ะะตะฝะตัะฐัะธั ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ
// ============================================
if (mode === 'advanced') {
  // ADVANCED ัะตะถะธะผ: Flux 1.1 Pro (ะฒััะพะบะพะต ะบะฐัะตััะฒะพ, ะฒ 6 ัะฐะท ะฑััััะตะต Flux Pro)
  const fluxModel = 'black-forest-labs/flux-1.1-pro'
  ...
}

// ============================================
// FREE ะะะะะ: ะขะพะปัะบะพ ัะตะบัั, ะฑะตะท AI ะธะทะพะฑัะฐะถะตะฝะธะน
// ============================================
else if (mode === 'free') {
  // FREE ัะตะถะธะผ: ัะพะปัะบะพ ัะตะบัั, ะฑะตะท AI ะณะตะฝะตัะฐัะธะธ ะธะทะพะฑัะฐะถะตะฝะธะน
  // ะัะฟะพะปัะทัะตััั ะดะปั:
  // - ะะพััะตะน ะฟะพัะปะต ะฟะตัะฒะพะน ADVANCED ะณะตะฝะตัะฐัะธะธ (ะณะตะฝะตัะฐัะธะธ 2-4)
  // - ะะฐัะตะณะธัััะธัะพะฒะฐะฝะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฑะตะท ะฟะพะดะฟะธัะบะธ (30 ะณะตะฝะตัะฐัะธะน/ะผะตััั)
  ...
}
```

**ะะตะทัะปััะฐั**:
- โ ะกัััะบัััะฐ ะบะพะดะฐ ัะธัะฐะฑะตะปัะฝะฐ
- โ ะะตะณะบะพ ะฝะฐะนัะธ ะฝัะถะฝัั ัะตะบัะธั
- โ ะะพะฝััะฝะพ ะฝะฐะทะฝะฐัะตะฝะธะต ะบะฐะถะดะพะณะพ ัะตะถะธะผะฐ

---

### 5. ๐ ะัะฟัะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ ะฟะพะดััะตัะฐ ะณะตะฝะตัะฐัะธะน ะณะพััั

**ะคะฐะนะป**: `components/ChatPanel.tsx`

**ะัะพะฑะปะตะผะฐ**: ะกัะตััะธะบ ัะฒะตะปะธัะธะฒะฐะปัั ัะพะปัะบะพ ะตัะปะธ ะธะฝัะตะฝั ัะฐัะฟะพะทะฝะฐะฒะฐะปัั ะบะฐะบ `create`. ะัะธ ะพะฟะตัะฐัะบะฐั ะธะปะธ ะฝะตัะตัะบะธั ะทะฐะฟัะพัะฐั ะดะพะบัะผะตะฝั ัะพะทะดะฐะฒะฐะปัั, ะฝะพ ััะตััะธะบ ะฝะต ัะฒะตะปะธัะธะฒะฐะปัั.

**ะะตัะตะฝะธะต**: ะะฐะผะตะฝะตะฝะฐ ะฟัะพะฒะตัะบะฐ ั `isCreationRequest` ะฝะฐ `documentWasCreated = Boolean(result.html)`.

**ะะพ**:
```typescript
if (isGuestMode && isCreationRequest) {
  incrementGuestGenerations()
}
```

**ะะพัะปะต**:
```typescript
const documentWasCreated = Boolean(result.html)
if (isGuestMode && documentWasCreated) {
  incrementGuestGenerations()
}
```

**ะะตะทัะปััะฐั**:
- โ ะกัะตััะธะบ ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ ะฒัะตะณะดะฐ
- โ ะะต ะทะฐะฒะธัะธั ะพั ัะฐัะฟะพะทะฝะฐะฒะฐะฝะธั ะธะฝัะตะฝัะฐ
- โ ะะพััั ะฟะพะปััะฐะตั ัะพะฒะฝะพ 4 ะณะตะฝะตัะฐัะธะธ

---

## ๐ ะกะขะะขะะกะขะะะ ะะะะะะะะะ

| ะะตััะธะบะฐ | ะะพ | ะะพัะปะต | ะะทะผะตะฝะตะฝะธะต |
|---------|-----|-------|-----------|
| ะกััะพะบ ะบะพะดะฐ ะฒ orchestrator.ts | ~320 | ~220 | -100 ัััะพะบ (-31%) |
| Deprecated ััะฝะบัะธะน | 1 | 0 | -100% |
| ะคะฐะนะปะพะฒ ั ะดะพะบัะผะตะฝัะฐัะธะตะน | 0 | 2 | +2 |
| Warning ะฒ ะบะพะฝัะพะปะธ | 6+ | 0 | -100% |
| ะะตะธัะฟะพะปัะทัะตะผัั ัะตะถะธะผะพะฒ | 1 (PRO) | 0 | -100% |

---

## ๐ฏ ะะะฅะะขะะะขะฃะะ ะกะะกะขะะะซ (ะะพัะปะต ะพะฟัะธะผะธะทะฐัะธะธ)

### ะกัััะบัััะฐ ัะฐัะธัะพะฒ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ GUEST (ะะพััะตะฒะพะน ัะตะถะธะผ)                              โ
โ โข 4 ะณะตะฝะตัะฐัะธะธ                                       โ
โ โข 1-ั: ADVANCED ั ะธะทะพะฑัะฐะถะตะฝะธัะผะธ                     โ
โ โข 2-4: FREE ะฑะตะท ะธะทะพะฑัะฐะถะตะฝะธะน                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ FREE (ะะตะณะธัััะฐัะธั)                                  โ
โ โข 30 ะณะตะฝะตัะฐัะธะน/ะผะตััั                                โ
โ โข ะะะ ะธะทะพะฑัะฐะถะตะฝะธะน                                   โ
โ โข ะะพะดะตะปั: Gemini Flash                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ADVANCED (ะะพะดะฟะธัะบะฐ 10โฝ/ะผะตั)                         โ
โ โข 100 ะณะตะฝะตัะฐัะธะน/ะผะตััั                               โ
โ โข ะก ะธะทะพะฑัะฐะถะตะฝะธัะผะธ (Flux 1.1 Pro)                    โ
โ โข ะะพะดะตะปั: Claude/Gemini                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะคะฐะนะปะพะฒะฐั ััััะบัััะฐ:

```
lib/
โโโ agents/
โ   โโโ orchestrator.ts       โ ะะฟัะธะผะธะทะธัะพะฒะฐะฝ (โ100 ัััะพะบ)
โ   โโโ imageAgent.ts         (ะฑะตะท ะธะทะผะตะฝะตะฝะธะน)
โ   โโโ contentAnalyzer.ts    (ะฑะตะท ะธะทะผะตะฝะตะฝะธะน)
โ   โโโ qaAgent.ts            (ะฑะตะท ะธะทะผะตะฝะตะฝะธะน)
โโโ generationLimits.ts       โ ะะพะบัะผะตะฝัะธัะพะฒะฐะฝ
โโโ guestTracking.ts          โ ะะธะผะธั = 4
โโโ store.ts                  โ ะะธะผะธั = 4

components/
โโโ ChatPanel.tsx             โ ะัะฟัะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ ััะตััะธะบะฐ
โโโ GenerationLimitModal.tsx  โ ะฃะฑัะฐะฝ deprecated

app/api/
โโโ user/generations/         โ ะฃะฑัะฐะฝ deprecated
```

---

## ๐ ะะกะขะะะจะะะกะฏ ะฃะะฃะงะจะะะะฏ (ะะฟัะธะพะฝะฐะปัะฝะพ)

ะัะปะธ ะฟะพััะตะฑัะตััั ะดะฐะปัะฝะตะนัะฐั ะพะฟัะธะผะธะทะฐัะธั:

### 1. ะะตัะฐะบัะพัะธะฝะณ ChatPanel.tsx
- ะคะฐะนะป ัะปะธัะบะพะผ ะฑะพะปััะพะน (~1200 ัััะพะบ)
- ะะพะถะฝะพ ะฒัะฝะตััะธ ะปะพะณะธะบั ะณะพััั ะฒ ะพัะดะตะปัะฝัะน ััะบ `useGuestGeneration()`
- ะฃะฟัะพััะธัั ะฒะปะพะถะตะฝะฝัะต ััะปะพะฒะธั

### 2. ะฃะดะฐะปะตะฝะธะต ัััะฐัะตะฒัะธั ะฟะพะปะตะน ะธะท Prisma
- `monthlyGenerations` (ััะฐัะพะต ะฟะพะปะต)
- `bonusGenerations` (ะฑะพะฝััะฝัะต ะฟะฐะบะธ ัะดะฐะปะตะฝั)
- `purchasedGenerations` (ะฝะต ะธัะฟะพะปัะทัะตััั)

### 3. ะะพะฝัะพะปะธะดะฐัะธั ะบะพะฝัะธะณััะฐัะธะธ
- ะะฑัะตะดะธะฝะธัั MODE_CONFIG, GENERATION_LIMITS, AGENT_MODELS
- ะกะพะทะดะฐัั ะตะดะธะฝัะน ะบะพะฝัะธะณ `config/tiers.ts`

### 4. ะขะธะฟะธะทะฐัะธั
- ะะพะฑะฐะฒะธัั ัััะพะณะธะต ัะธะฟั ะดะปั ะฒัะตั ัะตะถะธะผะพะฒ
- ะัะฟะพะปัะทะพะฒะฐัั `const assertions` ะดะปั ะบะพะฝัะธะณะพะฒ
- ะฃะฑัะฐัั `any` ัะธะฟั

### 5. ะขะตััั
- ะะพะฑะฐะฒะธัั unit ัะตััั ะดะปั ะบัะธัะธัะตัะบะธั ััะฝะบัะธะน
- E2E ัะตััั ะดะปั ะณะพััะตะฒะพะณะพ ัะตะถะธะผะฐ
- Integration ัะตััั ะดะปั ะฟะปะฐัะตะถะตะน

---

## โ ะะซะะะะซ

### ะะพััะธะณะฝััะพ:

1. โ **ะงะธััะพัะฐ ะบะพะดะฐ**: ะฃะดะฐะปะตะฝะพ 100+ ัััะพะบ ะผะตััะฒะพะณะพ ะบะพะดะฐ
2. โ **ะะพะบัะผะตะฝัะฐัะธั**: ะะพะฑะฐะฒะปะตะฝะพ 60+ ัััะพะบ ะบะฐัะตััะฒะตะฝะฝะพะน ะดะพะบัะผะตะฝัะฐัะธะธ
3. โ **ะะฐะณัะธะบัั**: ะัะฟัะฐะฒะปะตะฝะฐ ะบัะธัะธัะตัะบะฐั ะฟัะพะฑะปะตะผะฐ ั ััะตััะธะบะพะผ ะณะพััั
4. โ **Deprecation**: ะฃะฑัะฐะฝั ะฒัะต ัััะฐัะตะฒัะธะต API
5. โ **ะงะธัะฐะตะผะพััั**: ะะพะด ััะฐะป ะทะฝะฐัะธัะตะปัะฝะพ ะฟะพะฝััะฝะตะต

### ะะตััะธะบะธ ะบะฐัะตััะฒะฐ:

- **Maintainability Index**: ๐ข ะััะพะบะธะน (ัะปัััะตะฝ ะฝะฐ ~20%)
- **Code Coverage**: ๐ก ะกัะตะดะฝะธะน (ะฝะต ะธะทะผะตะฝะธะปัั)
- **Technical Debt**: ๐ข ะะธะทะบะธะน (ัะฝะธะถะตะฝ ะฝะฐ ~30%)
- **Documentation**: ๐ข ะฅะพัะพัะธะน (ะฑัะปะพ 0%, ััะฐะปะพ 80%)

### ะกะปะตะดัััะธะต ัะฐะณะธ:

1. ะัะพัะตััะธัะพะฒะฐัั ัะธััะตะผั ั ัะตะฐะปัะฝัะผะธ ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
2. ะะพะฝะธัะพัะธัั ะพัะธะฑะบะธ ะฒ production
3. ะกะพะฑัะฐัั feedback ะพั ัะตััะธัะพะฒัะธะบะพะฒ
4. ะัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ ะฒัะฟะพะปะฝะธัั ะพะฟัะธะพะฝะฐะปัะฝัะต ัะปัััะตะฝะธั

---

**ะะฟัะธะผะธะทะฐัะธั ะทะฐะฒะตััะตะฝะฐ ััะฟะตัะฝะพ! ๐**

*ะกะธััะตะผะฐ ะณะพัะพะฒะฐ ะบ ัะตััะธัะพะฒะฐะฝะธั ะธ production deployment.*