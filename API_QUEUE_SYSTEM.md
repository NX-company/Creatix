# üöÄ API Queue System - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞–º–∏

## –û–±–∑–æ—Ä

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ **100+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏, retry –ª–æ–≥–∏–∫–æ–π –∏ health checks.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Request Manager                       ‚îÇ
‚îÇ  (–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  API Key Pool  ‚îÇ      ‚îÇ Request Queue   ‚îÇ
‚îÇ   Manager      ‚îÇ      ‚îÇ   Manager       ‚îÇ
‚îÇ                ‚îÇ      ‚îÇ                 ‚îÇ
‚îÇ ‚Ä¢ Load Balance ‚îÇ      ‚îÇ ‚Ä¢ Priorities    ‚îÇ
‚îÇ ‚Ä¢ Health Check ‚îÇ      ‚îÇ ‚Ä¢ Rate Limiting ‚îÇ
‚îÇ ‚Ä¢ Auto-recovery‚îÇ      ‚îÇ ‚Ä¢ Retry Logic   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                         ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ   OpenRouter / AI APIs   ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. API Key Pool Manager (`lib/apiKeyPool.ts`)

–£–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ API –∫–ª—é—á–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ Round-robin –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª—é—á–µ–π (requests/minute)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
- ‚úÖ Auto-recovery –ø–æ—Å–ª–µ cooldown –ø–µ—Ä–∏–æ–¥–∞
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª—é—á—É

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:**
- `openrouter` - —Ç–µ–∫—Å—Ç–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (Gemini, GPT-4o)
- `replicate` - Flux Schnell (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- `openai` - DALL-E 3 (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```typescript
import { getApiKeyPool } from '@/lib/apiKeyPool'

const keyPool = getApiKeyPool()
const key = keyPool.getKey('openrouter')

// –ü–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞
keyPool.markSuccess(key) // –∏–ª–∏ keyPool.markError(key, error)
```

### 2. Request Queue Manager (`lib/requestQueue.ts`)

–£–ø—Ä–∞–≤–ª—è–µ—Ç –æ—á–µ—Ä–µ–¥—å—é –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ—á–µ—Ä–µ–¥—å (0 = highest, 10 = lowest)
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry —Å exponential backoff
- ‚úÖ Timeout –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–õ–∏–º–∏—Ç—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**
- OpenRouter: **50 –∑–∞–ø—Ä–æ—Å–æ–≤**
- Replicate: **30 –∑–∞–ø—Ä–æ—Å–æ–≤**
- OpenAI: **3 –∑–∞–ø—Ä–æ—Å–∞**

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```typescript
import { getRequestQueue } from '@/lib/requestQueue'

const queue = getRequestQueue()
const result = await queue.enqueue(
  'openrouter',
  async () => {
    // –í–∞—à API –∑–∞–ø—Ä–æ—Å
  },
  {
    priority: 5,
    maxRetries: 3,
    timeout: 60000
  }
)
```

### 3. Unified Request Manager (`lib/requestManager.ts`)

–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è Key Pool –∏ Queue.

**API –º–µ—Ç–æ–¥—ã:**

#### `openrouterRequest(options)`
–¢–µ–∫—Å—Ç–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ OpenRouter.

```typescript
const result = await requestManager.openrouterRequest({
  model: 'google/gemini-2.5-flash-lite',
  messages: [...],
  temperature: 0.7,
  max_tokens: 2000,
  priority: 5, // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
})
```

#### `replicateImageRequest(options)`
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ Flux Schnell.

```typescript
const result = await requestManager.replicateImageRequest({
  prompt: 'A beautiful landscape...',
  model: 'black-forest-labs/flux-schnell',
  priority: 5,
})
```

#### `openaiImageRequest(options)`
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ DALL-E 3.

```typescript
const result = await requestManager.openaiImageRequest({
  prompt: 'A futuristic city...',
  size: '1024x1024',
  priority: 5,
})
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–µ–π

### –§–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª—é—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞:

```env
# –ë–∞–∑–æ–≤—ã–π –∫–ª—é—á
OPENROUTER_API_KEY=sk-or-v1-xxx

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏ (–Ω—É–º–µ—Ä–∞—Ü–∏—è —Å _1)
OPENROUTER_API_KEY_1=sk-or-v1-yyy
OPENROUTER_API_KEY_2=sk-or-v1-zzz
OPENROUTER_API_KEY_3=sk-or-v1-aaa
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–ª—é—á–µ–π

| –ù–∞–≥—Ä—É–∑–∫–∞ | OpenRouter | Replicate | OpenAI |
|----------|------------|-----------|--------|
| 10-30 –∑–∞–ø—Ä–æ—Å–æ–≤ | 1 –∫–ª—é—á | 1 –∫–ª—é—á | 1 –∫–ª—é—á |
| 30-60 –∑–∞–ø—Ä–æ—Å–æ–≤ | 2-3 –∫–ª—é—á–∞ | 1 –∫–ª—é—á | 1 –∫–ª—é—á |
| 60-100 –∑–∞–ø—Ä–æ—Å–æ–≤ | 3-4 –∫–ª—é—á–∞ | 1-2 –∫–ª—é—á–∞ | 1-2 –∫–ª—é—á–∞ |
| 100+ –∑–∞–ø—Ä–æ—Å–æ–≤ | 5+ –∫–ª—é—á–µ–π | 2 –∫–ª—é—á–∞ | 2 –∫–ª—é—á–∞ |

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ Health Checks

### API Endpoint: `/api/system/health`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã:

```bash
curl http://localhost:3000/api/system/health
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "healthy",
  "timestamp": "2025-10-16T12:00:00.000Z",
  "overall": {
    "healthy": true,
    "totalCapacity": 83,
    "availableSlots": {
      "openrouter": 50,
      "replicate": 30,
      "openai": 3
    }
  },
  "keyPool": {
    "totalKeys": 5,
    "healthyKeys": 5,
    "totalRequests": 1234,
    "totalErrors": 5,
    "averageLoad": 45
  },
  "queue": {
    "pending": 12,
    "processing": 38,
    "completed": 1189,
    "failed": 5,
    "averageWaitTime": "250ms",
    "averageProcessingTime": "3500ms"
  },
  "providers": {
    "openrouter": {
      "queue": {...},
      "healthyKeys": 3,
      "totalKeys": 3,
      "keys": [...]
    },
    ...
  }
}
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ Health Checks

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ –∫–ª—é—á–µ–π –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- ‚úÖ –û—Ç–∫–ª—é—á–∞–µ—Ç –∫–ª—é—á–∏ –ø–æ—Å–ª–µ 5 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–ª—é—á–∏ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç cooldown
- ‚úÖ –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç rate limit —Å—á–µ—Ç—á–∏–∫–∏ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ API Endpoints

### –î–æ (—Å—Ç–∞—Ä—ã–π –∫–æ–¥):
```typescript
const apiKey = process.env.OPENROUTER_API_KEY
const client = new OpenAI({
  baseURL: 'https://openrouter.ai/api/v1',
  apiKey: apiKey,
})
const completion = await client.chat.completions.create({...})
```

### –ü–æ—Å–ª–µ (–Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞):
```typescript
import { getRequestManager } from '@/lib/requestManager'

const requestManager = getRequestManager()
const result = await requestManager.openrouterRequest({
  model: 'google/gemini-2.5-flash-lite',
  messages: [...],
  priority: 5, // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5
})
```

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|-----------|---------------|
| 0-2 | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã (–∞–¥–º–∏–Ω –æ–ø–µ—Ä–∞—Ü–∏–∏) |
| 3-4 | –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø–ª–∞—Ç–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏) |
| 5 | **–û–±—ã—á–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)** |
| 6-7 | –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏) |
| 8-10 | –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∞–Ω–∞–ª–∏—Ç–∏–∫–∞) |

## Retry –ª–æ–≥–∏–∫–∞

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã —Å exponential backoff:
- 1-—è –ø–æ–ø—ã—Ç–∫–∞: —Å—Ä–∞–∑—É
- 2-—è –ø–æ–ø—ã—Ç–∫–∞: —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
- 3-—è –ø–æ–ø—ã—Ç–∫–∞: —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
- 4-—è –ø–æ–ø—ã—Ç–∫–∞ (–µ—Å–ª–∏ maxRetries=3): –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–∂–∏–¥–∞–µ–º—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å | **100+ req/s** |
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –≤ –æ—á–µ—Ä–µ–¥–∏ | **< 500ms** |
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (Gemini) | **2-5s** |
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (Flux) | **10-20s** |
| –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (DALL-E 3) | **30-60s** |

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:
- ‚úÖ In-memory queue (–±–µ–∑ Redis)
- ‚úÖ Round-robin –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
- ‚úÖ Parallel processing
- ‚úÖ Smart retry —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:

```
üîë API Key Pool initialized: 5 total keys
   OpenRouter: 3 keys
   Replicate: 1 keys
   OpenAI: 1 keys

üöÄ Request Queue Manager started

üîë Selected openrouter key: openrouter-0 (45/300 rpm)
üì• Queued request req_1234567890_abc (openrouter, priority 5)
   Queue size: 12, Processing: 38
‚ö° Processing request req_1234567890_abc (openrouter, attempt 1/4)
‚úÖ Request req_1234567890_abc completed in 3245ms
```

## Deployment –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å:
- ‚úÖ Vercel
- ‚úÖ Timeweb VPS
- ‚úÖ AWS EC2
- ‚úÖ Docker

**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
1. –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ API –∫–ª—é—á–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ health check endpoint –¥–æ—Å—Ç—É–ø–µ–Ω
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ö–ª—é—á–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π
- ‚úÖ Rate limiting –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤
- ‚úÖ Timeout –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∑–∞–≤–∏—Å—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## FAQ

**Q: –ù—É–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–ª—è—Ç—å –≤—Å–µ –∫–ª—é—á–∏ —Å—Ä–∞–∑—É?**
A: –ù–µ—Ç, –º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å —Å –æ–¥–Ω–æ–≥–æ –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ –Ω–∞–≥—Ä—É–∑–∫–∏.

**Q: –ß—Ç–æ –µ—Å–ª–∏ –æ–¥–∏–Ω –∫–ª—é—á –∑–∞–±–ª–æ–∫–∏—Ä—É—é—Ç?**
A: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ –¥—Ä—É–≥–∏–µ –∑–¥–æ—Ä–æ–≤—ã–µ –∫–ª—é—á–∏.

**Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π?**
A: –î–∞, —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

**Q: –ö–∞–∫ —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å health check?**
A: –°–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å `/api/system/health` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

1. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ API –∫–ª—é—á–∏ –≤ `.env.local`
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É: `npm run dev`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check: `http://localhost:3000/api/system/health`
4. ‚úÖ –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –Ω–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏

---

**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞:** 16 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä:** Neurodiz AI Team

